{"version":3,"file":"main.bundle.js","sources":["../src/request.js"],"sourcesContent":["\"use strict\"\n\nimport {Vue} from \"ui.vue\";\n\nlet Request = function() {\n    this.data = null;\n    this.signedParameters = null;\n    this.options = null;\n    this.url = null;\n};\n\nRequest.prototype.setSignedParameters = function(parameters) {\n    this.signedParameters = parameters;\n    return this;\n}\n\nRequest.prototype.setData = function(data) {\n    this.data = data;\n    return this;\n}\n\nRequest.prototype.setOptions = function(options) {\n    this.options = options;\n    return this;\n}\n\nRequest.prototype.setUrl = function(url) {\n    this.url = url;\n    return this;\n}\n\nRequest.prototype.send = function(componentMethod = null) {\n    let url = this.url;\n    let data = this.data;\n\n    return new Promise((resolve, reject) => {\n        let result = componentMethod !== null\n            ? this.sendToComponent(url, data, componentMethod)\n            : this.sendToModule(url, data);\n\n        result.then(response => {\n            if (response.status === \"success\" && response.hasOwnProperty(\"data\")) {\n                resolve(response.data);\n            } else {\n                reject(response);\n            }\n        })\n        .catch(error => {\n            if (error.hasOwnProperty(\"errors\")) {\n                let resultMessage = [];\n                const errors = error.errors;\n\n                for (let i in errors) {\n                    resultMessage.push(errors[i].message);\n                }\n\n                reject(resultMessage.join('</br>'));\n            } else {\n                reject(error);\n            }\n        });\n    });\n}\n\nRequest.prototype.sendToModule = function(url, data) {\n    return BX.ajax.runAction(\n        url,\n        {\n            data: data,\n            preparePost: true,\n            enctype: 'multipart/form-data'\n        }\n    );\n}\n\nRequest.prototype.sendToComponent = function(url, data, componentMethod) {\n    return BX.ajax.runComponentAction(\n        url,\n        componentMethod,\n        {\n            data: data,\n            mode: 'class',\n            //enctype: 'multipart/form-data',\n            signedParameters: this.signedParameters\n        }\n    );\n}\n\nRequest.install = function(Vue, options) {\n    Vue.prototype.$request = new Request();\n}\n\nVue.use(Request);\n\nexport default Request;"],"names":["Request","data","signedParameters","options","url","prototype","setSignedParameters","parameters","setData","setOptions","setUrl","send","componentMethod","Promise","resolve","reject","result","_this","sendToModule","sendToComponent","then","response","status","hasOwnProperty","catch","error","resultMessage","errors","i","push","message","join","BX","ajax","runAction","preparePost","enctype","runComponentAction","mode","install","Vue","$request","use"],"mappings":"+HAIA,GAAIA,CAAAA,CAAO,CAAG,UAAW,MAChBC,KAAO,IADS,MAEhBC,iBAAmB,IAFH,MAGhBC,QAAU,IAHM,MAIhBC,IAAM,IAJf,CAAA,CAOAJ,CAAO,CAACK,SAARL,CAAkBM,mBAAlBN,CAAwC,SAASO,CAAT,CAAqB,aACpDL,iBAAmBK,EACjB,IAFX,EAKAP,CAAO,CAACK,SAARL,CAAkBQ,OAAlBR,CAA4B,SAASC,CAAT,CAAe,aAClCA,KAAOA,EACL,IAFX,EAKAD,CAAO,CAACK,SAARL,CAAkBS,UAAlBT,CAA+B,SAASG,CAAT,CAAkB,aACxCA,QAAUA,EACR,IAFX,EAKAH,CAAO,CAACK,SAARL,CAAkBU,MAAlBV,CAA2B,SAASI,CAAT,CAAc,aAChCA,IAAMA,EACJ,IAFX,EAKAJ,CAAO,CAACK,SAARL,CAAkBW,IAAlBX,CAAyB,UAAiC,WAAA,CAAxBY,CAAwB,wDAAN,IAAM,CAClDR,CAAG,CAAG,KAAKA,GADuC,CAElDH,CAAI,CAAG,KAAKA,IAFsC,OAI/C,IAAIY,CAAAA,OAAJ,CAAY,SAACC,CAAD,CAAUC,CAAV,CAAqB,IAChCC,CAAAA,CAAM,CAAuB,IAApBJ,GAAAA,CAAe,CAEtBK,CAAI,CAACC,YAAL,CAAkBd,CAAlB,CAAuBH,CAAvB,CAFsB,CACtBgB,CAAI,CAACE,eAAL,CAAqBf,CAArB,CAA0BH,CAA1B,CAAgCW,CAAhC,EAGNI,CAAM,CAACI,IAAPJ,CAAY,SAAAK,CAAA,CAAY,CACI,SAApBA,GAAAA,CAAQ,CAACC,MAATD,EAAiCA,CAAQ,CAACE,cAATF,CAAwB,MAAxBA,CADjB,CAEhBP,CAAO,CAACO,CAAQ,CAACpB,IAAV,CAFS,CAIhBc,CAAM,CAACM,CAAD,CAJd,CAAAL,EAOCQ,KAPDR,CAOO,SAAAS,CAAA,CAAS,IACRA,CAAK,CAACF,cAANE,CAAqB,QAArBA,EAAgC,IAC5BC,CAAAA,CAAa,CAAG,EADY,CAE1BC,CAAM,CAAGF,CAAK,CAACE,MAFW,KAI3B,GAAIC,CAAAA,IAAKD,CAAAA,EACVD,CAAa,CAACG,IAAdH,CAAmBC,CAAM,CAACC,CAAD,CAAND,CAAUG,OAA7BJ,EAGJX,CAAM,CAACW,CAAa,CAACK,IAAdL,CAAmB,OAAnBA,CAAD,CARV,KAUIX,CAAAA,CAAM,CAACU,CAAD,CAlBd,CAAAT,CALG,CAAA,CAJX,EAiCAhB,CAAO,CAACK,SAARL,CAAkBkB,YAAlBlB,CAAiC,SAASI,CAAT,CAAcH,CAAd,CAAoB,OAC1C+B,CAAAA,EAAE,CAACC,IAAHD,CAAQE,SAARF,CACH5B,CADG4B,CAEH,CACI/B,IAAI,CAAEA,CADV,CAEIkC,WAAW,GAFf,CAGIC,OAAO,CAAE,qBAHb,CAFGJ,CADX,EAWAhC,CAAO,CAACK,SAARL,CAAkBmB,eAAlBnB,CAAoC,SAASI,CAAT,CAAcH,CAAd,CAAoBW,CAApB,CAAqC,OAC9DoB,CAAAA,EAAE,CAACC,IAAHD,CAAQK,kBAARL,CACH5B,CADG4B,CAEHpB,CAFGoB,CAGH,CACI/B,IAAI,CAAEA,CADV,CAEIqC,IAAI,CAAE,OAFV,CAIIpC,gBAAgB,CAAE,KAAKA,gBAJ3B,CAHG8B,CADX,EAaAhC,CAAO,CAACuC,OAARvC,CAAkB,SAASwC,CAAT,CAAuB,CACrCA,CAAG,CAACnC,SAAJmC,CAAcC,QAAdD,CAAyB,GAAIxC,CAAAA,CADjC,QAII0C,IAAI1C"}